## Алгоритм Обработки Данных Передвижения Курьера

### 1. Очистка данных
   - **Фильтрация выбросов**:
     - Применить метод для удаления аномальных значений, например, используя медианный фильтр или определяя точки, резко отклоняющиеся от предыдущих на значительное расстояние (например, более 50 метров, учитывая погрешность).
   - **Сглаживание резких скачков**:
     - Если две соседние точки показывают существенный скачок, а следующая точка возвращается к прежней траектории, считать её выбросом и удалить.

### 2. Мэп-матчинг
   - Получить данные дорожной сети в зоне передвижения курьера.
   - Сопоставить GPS-координаты с ближайшими дорогами на карте. Это улучшит прогнозирование мест стоянки или движения.
     - **Пример**:
       - Парковка около магазина плотно ассоциируется с отметками парковки курьера.
       - Скоростная дорога не ассоциируется с парковкой курьера, поэтому такую точку можно отметить как выброс и отфильтровать, либо интерпретировать как кратковременную остановку на светофоре.

### 3. Определение мест парковки
   - Если курьер остаётся в пределах небольшой географической области (радиусом, например, 50 метров) на протяжении определённого времени (например, больше 1–2 минут), можно предположить, что он находится на парковке.
   - Вычислить среднюю скорость за этот период; если она близка к нулю, вероятно, это парковка.

### 4. Фильтрация ложных парковок
   - Исключить кратковременные остановки (меньше 1–2 минут), поскольку они могут быть вызваны светофорами или другими временными задержками.
   - Настроить минимальное время простоя, чтобы не принимать такие остановки за парковку.

### 5. Определение выхода с места парковки
   - Установить минимальное расстояние от последней точки парковки, например, 50 метров.
   - Когда курьер выходит за этот радиус и его скорость стабильно выше пороговой, это точно указывает на его движение с парковки.

### 6. Алгоритм сглаживания траектории
   - Применить **сглаживающий алгоритм**, например, Kalman Filter или экспоненциальное сглаживание, для предсказания местоположения курьера на основе предыдущих точек.

### 7. Вычисление скорости и направления
   - На основе временных меток между точками рассчитать примерную скорость и направление.
   - Исключить парковки и кратковременные стоянки из расчётов.

### 8. Заполнение недостающих данных
   - Если GPS-сигнал теряется на некоторое время, использовать интерполяцию для заполнения промежутков на основании предыдущих точек.

### 9. Построение финального маршрута
   - После обработки всех данных, сглаженных и очищенных точек, построить траекторию на карте.
   - Отметить парковки или остановки для дальнейшего анализа.

